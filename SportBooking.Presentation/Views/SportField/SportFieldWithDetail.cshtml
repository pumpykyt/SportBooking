@model SportFieldDto
@using SportBooking.BLL.Dtos

@{
    var isAuthenticated = User?.Identity?.IsAuthenticated;
    var reservations = ViewData["Reservations"] as IEnumerable<ReservationDto>;
}

<script> 
      document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'listWeek',
            header: {
                  left: 'prev,next today',
                  center: 'title',
                  right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
            },
            displayEventTime: true
        });
        axios.get("https://localhost:7281/reservation/getsportfieldreservations?sportFieldId=@Model.Id")
             .then(response => {
                   response.data.forEach(t => calendar.addEvent({
                        title: t.title, 
                        start: t.start,
                        end: t.end,
                        color: t.primaryColor
                   }));
             });
        calendar.render();
      });
</script>

<div class="grid grid-cols-2 gap-20 container mx-auto pt-36 min-h-screen">
    <div class="block bg-blue-700 p-3 rounded-lg">
        <img class="rounded mx-auto" src="@Model.ImageUrl"/>
        <div class="text-white text-2xl text-center font-semibold my-3">@Model.Title</div>
        <div class="bg-white h-0.5 mb-3"></div>
        <div class="text-white text-lg text-center">@Model.Description</div>
        <div class="bg-white h-0.5 my-3"></div>
        <div class="text-white">
            Adress: @Model.Address
        </div>
        <div class="text-white">
            Worktime start: @Model.StartProgram AM
        </div>
        <div class="text-white">
            Worktime end: @Model.EndProgram AM
        </div>
        <div class="rounded-lg text-black uppercase mt-5 py-2 px-3 text-2xl text-white text-center font-bold bg-orange-500">
            Price per hour: @Model.PricePerHour$
        </div>
    </div>
    <div class="block">
        @if (isAuthenticated == true)
        {
            <div class="mb-4">
                <a class="text-white bg-blue-500 px-3 py-2 rounded" asp-controller="Reservation" asp-action="PostReservation" asp-route-sportFieldId="@Model.Id">
                    Create reservation
                </a>
            </div>
        }
        <div class="bg-blue-200 rounded p-2" id="calendar"></div>
    </div>
</div>
